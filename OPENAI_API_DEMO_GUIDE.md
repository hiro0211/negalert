# OpenAI API デモ動画撮影ガイド

## 📹 目的

モックデータを使用しながら、**実際にOpenAI APIにリクエストを送信し、レスポンスを受け取るまでの流れ**をデモ動画に収録するためのガイドです。

## ✅ 現在の設定状態

- **モックモード**: 有効（`NEXT_PUBLIC_USE_MOCK_DATA=true`）
- **OpenAI API**: **実際に実行される**
- **Supabase**: 読み込みのみモックから、書き込みはスキップ
- **Google API**: スキップ

## 🎯 AI分析機能の動作フロー

### 実際に動作する流れ

```
1. ユーザーがレビュー受信箱でレビューをクリック
   ↓
2. 「AI分析」ボタンをクリック
   ↓
3. フロントエンドから /api/reviews/[id]/analyze にPOSTリクエスト
   ↓
4. バックエンドがモックデータからレビューを取得
   ↓
5. 【重要】OpenAI APIにリクエスト送信 ← ここで実際の通信が発生
   ↓
6. OpenAI APIからレスポンス受信（3〜10秒）
   ↓
7. AI分析結果を表示（要約、リスク、カテゴリ、返信案）
   ↓
8. DB保存はスキップ（ログのみ）
```

## 🎬 デモ動画撮影手順

### 準備

1. **OpenAI API キーの確認**
   - `.env.local` に `OPENAI_API_KEY` が設定されていることを確認
   - 有効なAPIキーであることを確認（課金設定済み）

2. **モックモードの確認**
   ```bash
   # .env.local
   NEXT_PUBLIC_USE_MOCK_DATA=true
   OPENAI_API_KEY=sk-proj-...（実際のキー）
   ```

3. **開発サーバーの起動**
   ```bash
   npm run dev
   ```

4. **ブラウザの準備**
   - 開発者ツールを開く（F12）
   - Networkタブを開いて準備

### 撮影シナリオ

#### シーン1: レビュー選択

1. http://localhost:3000/dashboard/inbox にアクセス
2. 未返信の高リスクレビューを選択（例: ID `review-001`）
   - ⭐ **重要**: `review-001`〜`review-005`はAI分析前の状態
   - 「AI分析」ボタンが表示される
3. レビュー詳細が表示される

#### シーン2: AI分析の実行

1. **「AI分析」ボタンをクリック**
2. **ローディング表示が出る**（「分析中...」）
3. **開発者ツールのNetworkタブを表示**
   - `/api/reviews/review-001/analyze` へのPOSTリクエストを確認
   - Statusが保留中（Pending）になっていることを表示

#### シーン3: OpenAI APIとの通信（ここが重要！）

1. **ターミナルのログを表示**
   ```
   🤖 AI分析を開始: { reviewId: 'review-001', userId: '...' }
   [Mock] モックデータからレビューを取得: review-001
   🤖 OpenAI APIを呼び出し中...
   ```

2. **3〜10秒待機**（実際のAPI通信時間）

3. **レスポンス受信のログ**
   ```
   ✅ AI分析完了: {
     summary: "予約客に長時間待機させ...",
     risk: "high",
     categories: ["接客態度", "待ち時間", "料理品質"],
     ...
   }
   ```

#### シーン4: 分析結果の表示

1. **UI上に分析結果が表示される**
   - 要約: 「予約客に長時間待機させ、説明不足と料理品質に問題」
   - リスク: 高リスク（赤色表示）
   - カテゴリ: 接客態度、待ち時間、料理品質
   - 返信案: 「この度は大変申し訳ございませんでした...」

2. **開発者ツールのNetworkタブ**
   - リクエストのStatusが200になる
   - Responseタブで完全なJSON応答を確認

#### シーン5: 返信文の自動生成

1. **返信案をコピー**ボタンをクリック
2. 返信入力欄に貼り付け
3. 必要に応じて編集
4. **「返信を投稿」ボタンをクリック**（モックモードではGoogle APIはスキップ）

## 📊 デモで強調すべきポイント

### 1. OpenAI APIの実際の通信

- ✅ リクエスト送信時のローディング表示
- ✅ 実際の待機時間（3〜10秒）
- ✅ ターミナルログでAPIコールを確認
- ✅ NetworkタブでHTTPリクエスト/レスポンスを確認

### 2. AI分析の精度

- ✅ 日本語レビューの正確な理解
- ✅ リスクレベルの適切な判定
- ✅ カテゴリ分類の精度
- ✅ 自然な返信文の生成

### 3. ユーザー体験

- ✅ シームレスなUI/UX
- ✅ リアルタイムのフィードバック
- ✅ 即座に使える返信案

## 🎥 撮影のコツ

### カメラワーク

1. **画面分割**
   - 左: ブラウザ（アプリのUI）
   - 右: ターミナル（ログ表示）

2. **ズームイン**
   - AI分析ボタンをクリックする瞬間
   - OpenAI APIのレスポンス待機中
   - 分析結果が表示される瞬間

3. **テロップ**
   - 「Sending request to OpenAI API...」
   - 「Waiting for AI analysis...（3-10 seconds）」
   - 「AI analysis completed successfully!」

### タイミング

- **ボタンクリック**: 0:00
- **API送信**: 0:01（ログ表示）
- **待機中**: 0:02〜0:10（ローディング表示）
- **レスポンス**: 0:10（結果表示）
- **確認**: 0:11〜0:20（詳細を確認）

## 🔍 トラブルシューティング

### 問題: OpenAI APIエラー

**原因**: APIキーが無効、または課金設定がない

**解決策**:
```bash
# .env.local で有効なAPIキーを確認
OPENAI_API_KEY=sk-proj-...

# OpenAIダッシュボードで課金設定を確認
# https://platform.openai.com/account/billing
```

### 問題: レビューが見つからないエラー

**原因**: モックデータのレビューIDが存在しない

**解決策**:
```typescript
// デモ撮影用：AI分析前のレビュー（「AI分析」ボタン表示）
review-001  // ★1 高リスク（予約トラブル）← デモ推奨
review-002  // ★1 高リスク（接客態度）
review-003  // ★2 高リスク（衛生問題）
review-004  // ★2 高リスク（誇大広告）
review-005  // ★3 中リスク（普通評価）

// 比較用：AI分析済みレビュー（「再分析」ボタン表示）
review-006〜review-020  // すでに分析済み
```

### 問題: DB保存エラー

**原因**: モックモードでDB保存を試行

**確認**:
- コンソールに `[Mock] AI分析結果のDB保存をスキップ` と表示されればOK
- エラーが出る場合は、`USE_MOCK_DATA` 環境変数を確認

## 📝 撮影後のチェックリスト

- [ ] OpenAI APIへのリクエストが表示されている
- [ ] 実際の待機時間（3〜10秒）が収録されている
- [ ] AI分析結果が正確に表示されている
- [ ] NetworkタブでHTTP通信が確認できる
- [ ] ターミナルログが見やすく表示されている
- [ ] 返信文の自動生成が動作している
- [ ] UIのローディング表示が適切

## 🎬 動画の構成例

### タイトル
「NegAlert - AI-Powered Review Analysis Demo」

### 構成（30秒版）
```
0:00-0:05  レビュー受信箱の表示
0:05-0:08  review-001を選択（AI分析前の状態）
0:08-0:10  「AI分析」ボタンをクリック
0:10-0:20  OpenAI API通信中（ローディング + ログ）
0:20-0:25  AI分析結果の表示
0:25-0:30  返信文の自動生成と投稿
```

### 構成（60秒版）
```
0:00-0:10  アプリの紹介とダッシュボード
0:10-0:15  レビュー受信箱の表示
0:15-0:20  高リスクレビューの選択と詳細表示
0:20-0:25  AI分析ボタンをクリック
0:25-0:40  OpenAI API通信中（詳細なログとNetwork表示）
0:40-0:50  AI分析結果の詳細確認
0:50-0:60  返信文の編集と投稿、完了画面
```

## 🌐 Google OAuth審査での位置づけ

このAI分析機能のデモは、以下の点でGoogle OAuth審査に有利です：

1. **実際のAPI統合**: OpenAI APIとの実際の通信を示すことで、技術力を証明
2. **ユーザー価値**: Google Business Profile データをどのように活用しているか明確
3. **プライバシー保護**: モックデータを使用することで、実際のユーザーデータを公開しない
4. **スムーズなUX**: AI分析のレスポンス時間も含めた、リアルな使用感を示す

---

**最終更新日**: 2026-02-06  
**作成者**: AI Assistant  
**目的**: OpenAI API実行フローのデモ動画撮影ガイド
